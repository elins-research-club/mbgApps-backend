generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model Bahan {
  id                Int      @id @default(autoincrement())
  nama              String   @unique
  resep             Resep[]
  energi_kkal       Float?   @default(0)
  protein_g         Float?   @default(0)
  lemak_g           Float?   @default(0)
  karbohidrat_g     Float?   @default(0)
  serat_g           Float?   @default(0)
  abu_g             Float?   @default(0)
  kalsium_mg        Float?   @default(0)
  fosfor_mg         Float?   @default(0)
  besi_mg           Float?   @default(0)
  natrium_mg        Float?   @default(0)
  kalium_mg         Float?   @default(0)
  tembaga_mg        Float?   @default(0)
  seng_mg           Float?   @default(0)
  retinol_mcg       Float?   @default(0)
  b_kar_mcg         Float?   @default(0)
  karoten_total_mcg Float?   @default(0)
  thiamin_mg        Float?   @default(0)
  riboflavin_mg     Float?   @default(0)
  niasin_mg         Float?   @default(0)
  vitamin_c_mg      Float?   @default(0)
  isValidated       Boolean? @default(false)
}

model Menu {
  id             Int             @id @default(autoincrement())
  nama           String          @unique
  kategori       String
  resep          Resep[]
  komponenMenu   MenuKomposisi[] @relation("KomposisiInduk")
  digunakanDalam MenuKomposisi[] @relation("KomposisiAnak")
}

model Resep {
  id       Int   @id @default(autoincrement())
  menu_id  Int
  bahan_id Int
  gramasi  Float
  menu     Menu  @relation(fields: [menu_id], references: [id])
  bahan    Bahan @relation(fields: [bahan_id], references: [id])
}

model MenuKomposisi {
  id            Int    @id @default(autoincrement())
  menu_induk_id Int
  menu_induk    Menu   @relation("KomposisiInduk", fields: [menu_induk_id], references: [id])
  menu_anak_id  Int
  menu_anak     Menu   @relation("KomposisiAnak", fields: [menu_anak_id], references: [id])
  tipe_komponen String

  @@unique([menu_induk_id, menu_anak_id])
}
